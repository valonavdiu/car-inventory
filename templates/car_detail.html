
{% extends "base.html" %}
{% block content %}
  <div class="grid md:grid-cols-2 gap-6">
    <img src="{{ (car.images[0] if car.images else url_for('static', filename='hero.jpg')) }}" class="w-full rounded-2xl border shadow" alt="{{ car.make }} {{ car.model }}">
    <div>
      <h1 class="text-3xl font-bold">{{ car.year }} {{ car.make }} {{ car.model }}</h1>
      <div class="mt-1 text-slate-600">{{ car.fuel }} • {{ car.transmission }} • {{ car.color }} • {{ car.seats or '—' }} seats</div>
      <div class="mt-3">
        {% if car.type == "rent" %}
          <span class="inline-block px-3 py-1 rounded-xl bg-emerald-600 text-white">Rent</span>
          <span class="text-2xl font-semibold ml-2">{{ car.price_per_day }} €</span><span class="text-slate-600">/day</span>
        {% else %}
          <span class="inline-block px-3 py-1 rounded-xl bg-slate-800 text-white">For Sale</span>
          <span class="text-2xl font-semibold ml-2">{{ car.price }} €</span>
        {% endif %}
      </div>
      <div class="mt-5 flex flex-wrap gap-3">
        {% set phone = (car.contact.phone if car.contact and car.contact.phone else business.whatsapp) %}
        <a class="px-5 py-3 rounded-xl bg-emerald-600 text-white" href="https://wa.me/{{ phone | replace('+','') }}?text=Hello!%20I%27m%20interested%20in%20{{ car.year }}%20{{ car.make }}%20{{ car.model }}">WhatsApp</a>
        <a class="px-5 py-3 rounded-xl border" href="tel:{{ phone | replace(' ','') }}">Call</a>
      </div>
      {% if car.odometer %}<div class="mt-4 text-slate-700">Odometer: {{ "{:,}".format(car.odometer) }} km</div>{% endif %}
      {% if car.description %}<p class="mt-4 text-slate-700">{{ car.description }}</p>{% endif %}
    </div>
  </div>

  {% if car.images and car.images|length > 1 %}
    <h3 class="mt-8 text-xl font-semibold">More photos</h3>
    <div class="mt-3 grid grid-cols-2 md:grid-cols-4 gap-3">
      {% for url in car.images[1:] %}
        <img src="{{ url }}" class="w-full rounded-xl border">
      {% endfor %}
    </div>
  {% endif %}

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Vehicle",
    "brand": "{{ car.make }}",
    "model": "{{ car.model }}",
    "color": "{{ car.color }}",
    "vehicleTransmission": "{{ car.transmission }}",
    "fuelType": "{{ car.fuel }}",
    "name": "{{ car.year }} {{ car.make }} {{ car.model }}",
    {% if car.type == "sale" %}
    "offers": {"@type":"Offer","price":"{{ car.price }}","priceCurrency":"EUR","availability":"https://schema.org/InStock"}
    {% else %}
    "offers": {"@type":"Offer","price":"{{ car.price_per_day }}","priceCurrency":"EUR","priceSpecification":{"@type":"UnitPriceSpecification","unitText":"DAY"}}
    {% endif %}
  }
  </script>
{% endblock %}
